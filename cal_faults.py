# import pandas as pd
# from datetime import datetime, timedelta
#
# faults_path = "/workspace/data_preprocess/D/faults.csv"
# dst_file = "/workspace/data_preprocess/unique_faults.txt"
#
#
# def read_dataframe(path):
#     path = str(path)
#     if path.endswith("csv"):
#         return pd.read_csv(path)
#     elif path.endswith("pkl"):
#         return pd.read_pickle(path)
#     else:
#         return pd.read_csv(path)
#
#
# faults_info = read_dataframe(faults_path)
# index = 0
# dict_final = {}
# dict = {}
# sub_dict = {}
# sub_list = []
#
# while index < 156:
#     sub_dict = {}  # Initialize sub_dict inside the loop
#     root_cause = faults_info['root_cause_node'][index]
#     start_time_stamp = faults_info['timestamp'][index]
#     end_time_stamp = start_time_stamp + 300
#     device_graph_time_stamp = start_time_stamp + 300
#     sub_dict['start_time_stamp'] = start_time_stamp
#     sub_dict['end_time_stamp'] = end_time_stamp
#     sub_dict['device_graph_time_stamp'] = device_graph_time_stamp
#
#     res = dict.get(root_cause, "unknown")
#     if res == "unknown":
#         sub_list = [sub_dict]
#         dict[root_cause] = sub_list
#     else:
#         res.append(sub_dict)
#         dict[root_cause] = res
#
#     index += 1
#
# dict_final['train_ticket'] = dict
# print(dict_final)

# print("=----------------------------------------------")
# print(dict_final_online)
# Use the custom converter in json.dumps()
# json_str = json.dumps(dict_final)
# print(json_str)
# import json
# data2 = {'train_ticket': {'ts-basic-service-1': [{'start_time_stamp': 1645599600, 'end_time_stamp': 1645599900, 'device_graph_time_stamp': 1645599900}, {'start_time_stamp': 1646294400, 'end_time_stamp': 1646294700, 'device_graph_time_stamp': 1646294700}], 'ts-preserve-service-1': [{'start_time_stamp': 1645603200, 'end_time_stamp': 1645603500, 'device_graph_time_stamp': 1645603500}], 'node3 CPU': [{'start_time_stamp': 1645606800, 'end_time_stamp': 1645607100, 'device_graph_time_stamp': 1645607100}, {'start_time_stamp': 1645696800, 'end_time_stamp': 1645697100, 'device_graph_time_stamp': 1645697100}, {'start_time_stamp': 1645725600, 'end_time_stamp': 1645725900, 'device_graph_time_stamp': 1645725900}, {'start_time_stamp': 1646215200, 'end_time_stamp': 1646215500, 'device_graph_time_stamp': 1646215500}, {'start_time_stamp': 1646301600, 'end_time_stamp': 1646301900, 'device_graph_time_stamp': 1646301900}, {'start_time_stamp': 1646330400, 'end_time_stamp': 1646330700, 'device_graph_time_stamp': 1646330700}, {'start_time_stamp': 1646384400, 'end_time_stamp': 1646384700, 'device_graph_time_stamp': 1646384700}, {'start_time_stamp': 1646416800, 'end_time_stamp': 1646417100, 'device_graph_time_stamp': 1646417100}, {'start_time_stamp': 1646474400, 'end_time_stamp': 1646474700, 'device_graph_time_stamp': 1646474700}], 'node4 Memory': [{'start_time_stamp': 1645614000, 'end_time_stamp': 1645614300, 'device_graph_time_stamp': 1645614300}, {'start_time_stamp': 1645732800, 'end_time_stamp': 1645733100, 'device_graph_time_stamp': 1645733100}, {'start_time_stamp': 1645790400, 'end_time_stamp': 1645790700, 'device_graph_time_stamp': 1645790700}, {'start_time_stamp': 1645815600, 'end_time_stamp': 1645815900, 'device_graph_time_stamp': 1645815900}, {'start_time_stamp': 1646074800, 'end_time_stamp': 1646075100, 'device_graph_time_stamp': 1646075100}, {'start_time_stamp': 1646132400, 'end_time_stamp': 1646132700, 'device_graph_time_stamp': 1646132700}, {'start_time_stamp': 1646161200, 'end_time_stamp': 1646161500, 'device_graph_time_stamp': 1646161500}, {'start_time_stamp': 1646222400, 'end_time_stamp': 1646222700, 'device_graph_time_stamp': 1646222700}, {'start_time_stamp': 1646251200, 'end_time_stamp': 1646251500, 'device_graph_time_stamp': 1646251500}, {'start_time_stamp': 1646305200, 'end_time_stamp': 1646305500, 'device_graph_time_stamp': 1646305500}, {'start_time_stamp': 1646334000, 'end_time_stamp': 1646334300, 'device_graph_time_stamp': 1646334300}, {'start_time_stamp': 1646337600, 'end_time_stamp': 1646337900, 'device_graph_time_stamp': 1646337900}], 'node3 Memory': [{'start_time_stamp': 1645617600, 'end_time_stamp': 1645617900, 'device_graph_time_stamp': 1645617900}, {'start_time_stamp': 1645729200, 'end_time_stamp': 1645729500, 'device_graph_time_stamp': 1645729500}, {'start_time_stamp': 1646049600, 'end_time_stamp': 1646049900, 'device_graph_time_stamp': 1646049900}, {'start_time_stamp': 1646078400, 'end_time_stamp': 1646078700, 'device_graph_time_stamp': 1646078700}, {'start_time_stamp': 1646136000, 'end_time_stamp': 1646136300, 'device_graph_time_stamp': 1646136300}, {'start_time_stamp': 1646247600, 'end_time_stamp': 1646247900, 'device_graph_time_stamp': 1646247900}, {'start_time_stamp': 1646506800, 'end_time_stamp': 1646507100, 'device_graph_time_stamp': 1646507100}], 'ts-inside-payment-service-0 CPU': [{'start_time_stamp': 1645624800, 'end_time_stamp': 1645625100, 'device_graph_time_stamp': 1645625100}], 'ts-consign-price-mongo-0 Memory': [{'start_time_stamp': 1645628400, 'end_time_stamp': 1645628700, 'device_graph_time_stamp': 1645628700}], 'ts-order-service-2': [{'start_time_stamp': 1645686000, 'end_time_stamp': 1645686300, 'device_graph_time_stamp': 1645686300}, {'start_time_stamp': 1646182800, 'end_time_stamp': 1646183100, 'device_graph_time_stamp': 1646183100}], 'ts-seat-service-1': [{'start_time_stamp': 1645689600, 'end_time_stamp': 1645689900, 'device_graph_time_stamp': 1645689900}, {'start_time_stamp': 1646031600, 'end_time_stamp': 1646031900, 'device_graph_time_stamp': 1646031900}], 'node1 CPU': [{'start_time_stamp': 1645693200, 'end_time_stamp': 1645693500, 'device_graph_time_stamp': 1645693500}, {'start_time_stamp': 1645783200, 'end_time_stamp': 1645783500, 'device_graph_time_stamp': 1645783500}, {'start_time_stamp': 1645812000, 'end_time_stamp': 1645812300, 'device_graph_time_stamp': 1645812300}, {'start_time_stamp': 1646038800, 'end_time_stamp': 1646039100, 'device_graph_time_stamp': 1646039100}, {'start_time_stamp': 1646042400, 'end_time_stamp': 1646042700, 'device_graph_time_stamp': 1646042700}, {'start_time_stamp': 1646157600, 'end_time_stamp': 1646157900, 'device_graph_time_stamp': 1646157900}, {'start_time_stamp': 1646211600, 'end_time_stamp': 1646211900, 'device_graph_time_stamp': 1646211900}, {'start_time_stamp': 1646326800, 'end_time_stamp': 1646327100, 'device_graph_time_stamp': 1646327100}], 'ts-food-map-mongo-0 CPU': [{'start_time_stamp': 1645707600, 'end_time_stamp': 1645707900, 'device_graph_time_stamp': 1645707900}, {'start_time_stamp': 1646398800, 'end_time_stamp': 1646399100, 'device_graph_time_stamp': 1646399100}], 'ts-order-other-mongo-0 CPU': [{'start_time_stamp': 1645711200, 'end_time_stamp': 1645711500, 'device_graph_time_stamp': 1645711500}], 'ts-food-mongo-0 Memory': [{'start_time_stamp': 1645714800, 'end_time_stamp': 1645715100, 'device_graph_time_stamp': 1645715100}], 'ts-notification-service-1 CPU': [{'start_time_stamp': 1645736400, 'end_time_stamp': 1645736700, 'device_graph_time_stamp': 1645736700}], 'ts-food-map-service-0 CPU': [{'start_time_stamp': 1645740000, 'end_time_stamp': 1645740300, 'device_graph_time_stamp': 1645740300}], 'ts-order-service-1 Memory': [{'start_time_stamp': 1645743600, 'end_time_stamp': 1645743900, 'device_graph_time_stamp': 1645743900}], 'ts-basic-service-0 Memory': [{'start_time_stamp': 1645747200, 'end_time_stamp': 1645747500, 'device_graph_time_stamp': 1645747500}], 'ts-station-service-2': [{'start_time_stamp': 1645750800, 'end_time_stamp': 1645751100, 'device_graph_time_stamp': 1645751100}], 'ts-payment-service-1': [{'start_time_stamp': 1645754400, 'end_time_stamp': 1645754700, 'device_graph_time_stamp': 1645754700}], 'ts-order-other-service-1': [{'start_time_stamp': 1645758000, 'end_time_stamp': 1645758300, 'device_graph_time_stamp': 1645758300}], 'ts-route-service-1': [{'start_time_stamp': 1645761600, 'end_time_stamp': 1645761900, 'device_graph_time_stamp': 1645761900}], 'ts-config-service-1': [{'start_time_stamp': 1645765200, 'end_time_stamp': 1645765500, 'device_graph_time_stamp': 1645765500}, {'start_time_stamp': 1646449200, 'end_time_stamp': 1646449500, 'device_graph_time_stamp': 1646449500}, {'start_time_stamp': 1646452800, 'end_time_stamp': 1646453100, 'device_graph_time_stamp': 1646453100}], 'ts-inside-payment-service-1': [{'start_time_stamp': 1645768800, 'end_time_stamp': 1645769100, 'device_graph_time_stamp': 1645769100}], 'ts-station-service-1': [{'start_time_stamp': 1645772400, 'end_time_stamp': 1645772700, 'device_graph_time_stamp': 1645772700}, {'start_time_stamp': 1645848000, 'end_time_stamp': 1645848300, 'device_graph_time_stamp': 1645848300}, {'start_time_stamp': 1646197200, 'end_time_stamp': 1646197500, 'device_graph_time_stamp': 1646197500}], 'node4 CPU': [{'start_time_stamp': 1645779600, 'end_time_stamp': 1645779900, 'device_graph_time_stamp': 1645779900}, {'start_time_stamp': 1646071200, 'end_time_stamp': 1646071500, 'device_graph_time_stamp': 1646071500}, {'start_time_stamp': 1646128800, 'end_time_stamp': 1646129100, 'device_graph_time_stamp': 1646129100}, {'start_time_stamp': 1646244000, 'end_time_stamp': 1646244300, 'device_graph_time_stamp': 1646244300}, {'start_time_stamp': 1646298000, 'end_time_stamp': 1646298300, 'device_graph_time_stamp': 1646298300}, {'start_time_stamp': 1646413200, 'end_time_stamp': 1646413500, 'device_graph_time_stamp': 1646413500}, {'start_time_stamp': 1646470800, 'end_time_stamp': 1646471100, 'device_graph_time_stamp': 1646471100}], 'node2 Memory': [{'start_time_stamp': 1645786800, 'end_time_stamp': 1645787100, 'device_graph_time_stamp': 1645787100}, {'start_time_stamp': 1645819200, 'end_time_stamp': 1645819500, 'device_graph_time_stamp': 1645819500}, {'start_time_stamp': 1646046000, 'end_time_stamp': 1646046300, 'device_graph_time_stamp': 1646046300}, {'start_time_stamp': 1646164800, 'end_time_stamp': 1646165100, 'device_graph_time_stamp': 1646165100}, {'start_time_stamp': 1646218800, 'end_time_stamp': 1646219100, 'device_graph_time_stamp': 1646219100}, {'start_time_stamp': 1646308800, 'end_time_stamp': 1646309100, 'device_graph_time_stamp': 1646309100}, {'start_time_stamp': 1646391600, 'end_time_stamp': 1646391900, 'device_graph_time_stamp': 1646391900}, {'start_time_stamp': 1646420400, 'end_time_stamp': 1646420700, 'device_graph_time_stamp': 1646420700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-config-service-0 CPU': [{'start_time_stamp': 1645794000, 'end_time_stamp': 1645794300, 'device_graph_time_stamp': 1645794300}], 'ts-travel2-mongo-0 CPU': [{'start_time_stamp': 1645797600, 'end_time_stamp': 1645797900, 'device_graph_time_stamp': 1645797900}, {'start_time_stamp': 1646431200, 'end_time_stamp': 1646431500, 'device_graph_time_stamp': 1646431500}], 'ts-preserve-service-0 Memory': [{'start_time_stamp': 1645801200, 'end_time_stamp': 1645801500, 'device_graph_time_stamp': 1645801500}, {'start_time_stamp': 1646348400, 'end_time_stamp': 1646348700, 'device_graph_time_stamp': 1646348700}], 'ts-consign-price-mongo-0 CPU': [{'start_time_stamp': 1645822800, 'end_time_stamp': 1645823100, 'device_graph_time_stamp': 1645823100}], 'ts-price-service-1 Memory': [{'start_time_stamp': 1645830000, 'end_time_stamp': 1645830300, 'device_graph_time_stamp': 1645830300}], 'ts-payment-service-0 Memory': [{'start_time_stamp': 1645833600, 'end_time_stamp': 1645833900, 'device_graph_time_stamp': 1645833900}], 'ts-basic-service-2': [{'start_time_stamp': 1645837200, 'end_time_stamp': 1645837500, 'device_graph_time_stamp': 1645837500}, {'start_time_stamp': 1646107200, 'end_time_stamp': 1646107500, 'device_graph_time_stamp': 1646107500}], 'ts-order-other-service-2': [{'start_time_stamp': 1645840800, 'end_time_stamp': 1645841100, 'device_graph_time_stamp': 1645841100}, {'start_time_stamp': 1646110800, 'end_time_stamp': 1646111100, 'device_graph_time_stamp': 1646111100}], 'ts-contacts-service-1': [{'start_time_stamp': 1645844400, 'end_time_stamp': 1645844700, 'device_graph_time_stamp': 1645844700}, {'start_time_stamp': 1646121600, 'end_time_stamp': 1646121900, 'device_graph_time_stamp': 1646121900}], 'ts-station-service-0': [{'start_time_stamp': 1645851600, 'end_time_stamp': 1645851900, 'device_graph_time_stamp': 1645851900}, {'start_time_stamp': 1646290800, 'end_time_stamp': 1646291100, 'device_graph_time_stamp': 1646291100}], 'ts-consign-service-1': [{'start_time_stamp': 1645855200, 'end_time_stamp': 1645855500, 'device_graph_time_stamp': 1645855500}, {'start_time_stamp': 1646370000, 'end_time_stamp': 1646370300, 'device_graph_time_stamp': 1646370300}, {'start_time_stamp': 1646463600, 'end_time_stamp': 1646463900, 'device_graph_time_stamp': 1646463900}], 'ts-route-service-0': [{'start_time_stamp': 1646020800, 'end_time_stamp': 1646021100, 'device_graph_time_stamp': 1646021100}, {'start_time_stamp': 1646456400, 'end_time_stamp': 1646456700, 'device_graph_time_stamp': 1646456700}], 'ts-order-service-0': [{'start_time_stamp': 1646024400, 'end_time_stamp': 1646024700, 'device_graph_time_stamp': 1646024700}], 'ts-food-service-1': [{'start_time_stamp': 1646035200, 'end_time_stamp': 1646035500, 'device_graph_time_stamp': 1646035500}, {'start_time_stamp': 1646200800, 'end_time_stamp': 1646201100, 'device_graph_time_stamp': 1646201100}, {'start_time_stamp': 1646276400, 'end_time_stamp': 1646276700, 'device_graph_time_stamp': 1646276700}], 'ts-consign-price-service-1 CPU': [{'start_time_stamp': 1646053200, 'end_time_stamp': 1646053500, 'device_graph_time_stamp': 1646053500}], 'ts-contacts-mongo-0 CPU': [{'start_time_stamp': 1646056800, 'end_time_stamp': 1646057100, 'device_graph_time_stamp': 1646057100}], 'ts-travel-service-0 Memory': [{'start_time_stamp': 1646060400, 'end_time_stamp': 1646060700, 'device_graph_time_stamp': 1646060700}], 'ts-preserve-service-1 CPU': [{'start_time_stamp': 1646082000, 'end_time_stamp': 1646082300, 'device_graph_time_stamp': 1646082300}], 'ts-route-mongo-0 CPU': [{'start_time_stamp': 1646085600, 'end_time_stamp': 1646085900, 'device_graph_time_stamp': 1646085900}], 'ts-consign-service-1 Memory': [{'start_time_stamp': 1646089200, 'end_time_stamp': 1646089500, 'device_graph_time_stamp': 1646089500}], 'ts-security-service-1 Memory': [{'start_time_stamp': 1646092800, 'end_time_stamp': 1646093100, 'device_graph_time_stamp': 1646093100}], 'ts-order-other-service-0': [{'start_time_stamp': 1646096400, 'end_time_stamp': 1646096700, 'device_graph_time_stamp': 1646096700}], 'ts-travel2-service-1': [{'start_time_stamp': 1646114400, 'end_time_stamp': 1646114700, 'device_graph_time_stamp': 1646114700}, {'start_time_stamp': 1646373600, 'end_time_stamp': 1646373900, 'device_graph_time_stamp': 1646373900}, {'start_time_stamp': 1646377200, 'end_time_stamp': 1646377500, 'device_graph_time_stamp': 1646377500}], 'node2 CPU': [{'start_time_stamp': 1646125200, 'end_time_stamp': 1646125500, 'device_graph_time_stamp': 1646125500}, {'start_time_stamp': 1646154000, 'end_time_stamp': 1646154300, 'device_graph_time_stamp': 1646154300}, {'start_time_stamp': 1646388000, 'end_time_stamp': 1646388300, 'device_graph_time_stamp': 1646388300}], 'ts-auth-service-0 CPU': [{'start_time_stamp': 1646139600, 'end_time_stamp': 1646139900, 'device_graph_time_stamp': 1646139900}], 'ts-travel-plan-service-0 CPU': [{'start_time_stamp': 1646143200, 'end_time_stamp': 1646143500, 'device_graph_time_stamp': 1646143500}, {'start_time_stamp': 1646316000, 'end_time_stamp': 1646316300, 'device_graph_time_stamp': 1646316300}], 'ts-price-mongo-0 Memory': [{'start_time_stamp': 1646146800, 'end_time_stamp': 1646147100, 'device_graph_time_stamp': 1646147100}], 'ts-food-map-service-1 CPU': [{'start_time_stamp': 1646168400, 'end_time_stamp': 1646168700, 'device_graph_time_stamp': 1646168700}], 'ts-consign-service-0 CPU': [{'start_time_stamp': 1646172000, 'end_time_stamp': 1646172300, 'device_graph_time_stamp': 1646172300}], 'ts-news-service-1 Memory': [{'start_time_stamp': 1646179200, 'end_time_stamp': 1646179500, 'device_graph_time_stamp': 1646179500}], 'ts-ticketinfo-service-1': [{'start_time_stamp': 1646186400, 'end_time_stamp': 1646186700, 'device_graph_time_stamp': 1646186700}, {'start_time_stamp': 1646190000, 'end_time_stamp': 1646190300, 'device_graph_time_stamp': 1646190300}], 'ts-price-service-1': [{'start_time_stamp': 1646193600, 'end_time_stamp': 1646193900, 'device_graph_time_stamp': 1646193900}, {'start_time_stamp': 1646280000, 'end_time_stamp': 1646280300, 'device_graph_time_stamp': 1646280300}], 'ts-auth-service-1': [{'start_time_stamp': 1646204400, 'end_time_stamp': 1646204700, 'device_graph_time_stamp': 1646204700}], 'ts-config-service-0': [{'start_time_stamp': 1646208000, 'end_time_stamp': 1646208300, 'device_graph_time_stamp': 1646208300}, {'start_time_stamp': 1646362800, 'end_time_stamp': 1646363100, 'device_graph_time_stamp': 1646363100}], 'ts-ui-dashboard-0 CPU': [{'start_time_stamp': 1646226000, 'end_time_stamp': 1646226300, 'device_graph_time_stamp': 1646226300}], 'ts-admin-basic-info-service-0 CPU': [{'start_time_stamp': 1646229600, 'end_time_stamp': 1646229900, 'device_graph_time_stamp': 1646229900}], 'ts-ticket-office-service-0 Memory': [{'start_time_stamp': 1646233200, 'end_time_stamp': 1646233500, 'device_graph_time_stamp': 1646233500}], 'ts-user-mongo-0 CPU': [{'start_time_stamp': 1646254800, 'end_time_stamp': 1646255100, 'device_graph_time_stamp': 1646255100}], 'ts-preserve-service-0 CPU': [{'start_time_stamp': 1646258400, 'end_time_stamp': 1646258700, 'device_graph_time_stamp': 1646258700}], 'ts-route-service-0 Memory': [{'start_time_stamp': 1646262000, 'end_time_stamp': 1646262300, 'device_graph_time_stamp': 1646262300}], 'ts-train-mongo-0 Memory': [{'start_time_stamp': 1646265600, 'end_time_stamp': 1646265900, 'device_graph_time_stamp': 1646265900}], 'ts-assurance-service-0': [{'start_time_stamp': 1646269200, 'end_time_stamp': 1646269500, 'device_graph_time_stamp': 1646269500}], 'ts-payment-service-0': [{'start_time_stamp': 1646272800, 'end_time_stamp': 1646273100, 'device_graph_time_stamp': 1646273100}], 'ts-price-service-0': [{'start_time_stamp': 1646287200, 'end_time_stamp': 1646287500, 'device_graph_time_stamp': 1646287500}], 'ts-payment-service-1 CPU': [{'start_time_stamp': 1646312400, 'end_time_stamp': 1646312700, 'device_graph_time_stamp': 1646312700}], 'ts-travel-service-1 Memory': [{'start_time_stamp': 1646319600, 'end_time_stamp': 1646319900, 'device_graph_time_stamp': 1646319900}], 'ts-route-service-1 Memory': [{'start_time_stamp': 1646352000, 'end_time_stamp': 1646352300, 'device_graph_time_stamp': 1646352300}], 'ts-verification-code-service-1': [{'start_time_stamp': 1646355600, 'end_time_stamp': 1646355900, 'device_graph_time_stamp': 1646355900}], 'ts-auth-service-0': [{'start_time_stamp': 1646380800, 'end_time_stamp': 1646381100, 'device_graph_time_stamp': 1646381100}], 'ts-train-service-1 CPU': [{'start_time_stamp': 1646427600, 'end_time_stamp': 1646427900, 'device_graph_time_stamp': 1646427900}], 'ts-food-service-1 Memory': [{'start_time_stamp': 1646434800, 'end_time_stamp': 1646435100, 'device_graph_time_stamp': 1646435100}], 'ts-train-service-1 Memory': [{'start_time_stamp': 1646438400, 'end_time_stamp': 1646438700, 'device_graph_time_stamp': 1646438700}], 'ts-consign-price-service-0': [{'start_time_stamp': 1646442000, 'end_time_stamp': 1646442300, 'device_graph_time_stamp': 1646442300}], 'ts-execute-service-0': [{'start_time_stamp': 1646445600, 'end_time_stamp': 1646445900, 'device_graph_time_stamp': 1646445900}], 'ts-travel2-service-0': [{'start_time_stamp': 1646460000, 'end_time_stamp': 1646460300, 'device_graph_time_stamp': 1646460300}], 'ts-security-service-1': [{'start_time_stamp': 1646467200, 'end_time_stamp': 1646467500, 'device_graph_time_stamp': 1646467500}], 'ts-user-service-0 Memory': [{'start_time_stamp': 1646492400, 'end_time_stamp': 1646492700, 'device_graph_time_stamp': 1646492700}]}}
# data2 = {'train_ticket': {'ts-basic-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-preserve-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node3 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node4 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node3 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-inside-payment-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-price-mongo-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-service-2': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-seat-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-map-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-other-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-mongo-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-notification-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-map-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-basic-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-station-service-2': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-payment-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-other-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-route-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-config-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-inside-payment-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-station-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node4 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node2 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-config-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel2-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-preserve-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-price-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-price-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-payment-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-basic-service-2': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-other-service-2': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-contacts-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-station-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-route-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-price-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-contacts-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-preserve-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-route-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-security-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-other-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel2-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node2 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-auth-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel-plan-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-price-mongo-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-map-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-news-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-ticketinfo-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-price-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-auth-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-config-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-ui-dashboard-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-admin-basic-info-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-ticket-office-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-user-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-preserve-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-route-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-train-mongo-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-assurance-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-payment-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-price-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-payment-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-route-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-verification-code-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-auth-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-train-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-train-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-price-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-execute-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel2-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-security-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-user-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}]}}
# data2 = {'train_ticket': {'ts-preserve-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node4 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-inside-payment-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-service-2': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-map-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-mongo-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node3 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-notification-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-station-service-2': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-other-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-config-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-station-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel2-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node2 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-price-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-basic-service-2': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-contacts-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-station-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-route-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-seat-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-price-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-preserve-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-other-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-other-service-2': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node4 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel-plan-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node2 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-map-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-news-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-ticketinfo-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-price-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-config-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node3 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-admin-basic-info-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-preserve-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-train-mongo-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-payment-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-payment-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-route-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel2-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-auth-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-train-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-price-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-user-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}]}}
# data = {'train_ticket': {'ts-basic-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node3 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node3 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-price-mongo-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-seat-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-other-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node4 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-map-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-basic-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-payment-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-route-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-inside-payment-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node4 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node2 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-config-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-preserve-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-price-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-payment-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-other-service-2': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-station-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-contacts-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-route-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-security-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-basic-service-2': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel2-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node2 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-auth-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-price-mongo-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-service-2': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-ticketinfo-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-auth-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-ui-dashboard-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-ticket-office-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-user-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-route-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-assurance-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-price-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel-plan-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-verification-code-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel2-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-train-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-execute-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-config-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel2-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-security-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}]}}
# data = {'train_ticket': {'ts-basic-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-preserve-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node3 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node4 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node3 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-inside-payment-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-price-mongo-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-service-2': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-seat-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-map-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-other-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-mongo-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-notification-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-map-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-basic-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-station-service-2': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-payment-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-other-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-route-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-config-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-inside-payment-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-station-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node4 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node2 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-config-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel2-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-preserve-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-price-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-price-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-payment-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-basic-service-2': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-other-service-2': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-contacts-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-station-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-route-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-price-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-contacts-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-preserve-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-route-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-security-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-order-other-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel2-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'node2 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-auth-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel-plan-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-price-mongo-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-map-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-news-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-ticketinfo-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-price-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-auth-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-config-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}, {'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-ui-dashboard-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-admin-basic-info-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-ticket-office-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-user-mongo-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-preserve-service-0 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-route-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-train-mongo-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-assurance-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-payment-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-price-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-payment-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-route-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-verification-code-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-auth-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-train-service-1 CPU': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-food-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-train-service-1 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-consign-price-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-execute-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-travel2-service-0': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-security-service-1': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}], 'ts-user-service-0 Memory': [{'start_time_stamp': 1646510400, 'end_time_stamp': 1646510700, 'device_graph_time_stamp': 1646510700}]}}
# with open("/workspace/data_preprocess/offline_data_set_info.json", "w") as f:
#     json.dump(data2, f)

import os
import json
from itertools import product
from pathlib import Path
from pprint import pformat
from typing import Union, Optional, Any, Dict, List

import networkx as nx
from loguru import logger
from networkx.drawing.nx_agraph import write_dot
from yaml import load, CLoader as Loader


def insert_global_params(keys: List[str], global_params: Dict[str, Any], target: Dict[str, Any]):
    for key in keys:
        assert key in global_params
        target[key] = global_params[key]
    return target


def parse_yaml_graph_config(path: Union[str, Path], output_dir: Optional[Path] = None) -> nx.DiGraph:
    def metrics_sorted(metrics):
        return sorted(metrics, key=lambda _: _.split("##")[1])

    timestp = 1582078501
    path = Path(path)
    logger.debug(f"parsing Graph from {path!s}")
    with open(path) as f:
        input_data = load(f, Loader=Loader)
    g = nx.DiGraph()
    global_params = {}
    all_values = []
    for obj in input_data:
        if obj.get('class', "") == "global_params":
            global_params = obj
            break
    # parse nodes in the first pass
    for obj in input_data:
        try:
            if obj['class'] != "node":
                continue
            if "params" in obj or "global_params" in obj:
                params = obj.get("params", {})
                insert_global_params(obj.get('global_params', []), global_params, params)
                keys = list(params.keys())
                if obj.get('product', False):
                    for values in product(*params.values()):
                        node_id = obj["id"].format(**{k: v for k, v in zip(keys, values)})
                        print("node_id")
                        print(node_id)
                        node_metrics = [_.format(**{k: v for k, v in zip(keys, values)}) for _ in obj["metrics"]]
                        g.add_node(node_id, **{"metrics": metrics_sorted(node_metrics), "type": obj["type"]})
                else:
                    values_list = list(zip(*params.values()))
                    for values in values_list:
                        node_id = obj["id"].format(**{k: v for k, v in zip(keys, values)})
                        node_metrics = [_.format(**{k: v for k, v in zip(keys, values)}) for _ in obj["metrics"]]
                        g.add_node(node_id, **{"metrics": metrics_sorted(node_metrics), "type": obj["type"]})
            else:
                g.add_node(obj['id'], **{"metrics": metrics_sorted(obj['metrics']), "type": obj["type"]})
        except KeyError as e:
            logger.error(f"{e!r} obj={pformat(obj)}")

    def add_edge(_src, _dst, _attrs):
        if _src in g and _dst in g:  # ignore edges that don't exist
            g.add_edge(_src, _dst, **_attrs)
        else:
            logger.warning(f"ignoring edge {_src} -> {_dst}")

    # parse edges in the second pass
    for obj in input_data:
        try:
            if obj['class'] != "edge":
                continue
            if "params" in obj or "global_params" in obj:
                params = obj.get('params', {})
                insert_global_params(obj.get('global_params', []), global_params, params)
                keys = list(params.keys())
                if obj.get('product', False):
                    for values in product(*params.values()):
                        src = obj["src"].format(**{k: v for k, v in zip(keys, values)})
                        dst = obj["dst"].format(**{k: v for k, v in zip(keys, values)})
                        add_edge(src, dst, {"type": obj["type"]})
                else:
                    values_list = list(zip(*params.values()))
                    dict_1 = {}
                    dict_2 = {}
                    for values in values_list:
                        src = obj["src"].format(**{k: v for k, v in zip(keys, values)})
                        dst = obj["dst"].format(**{k: v for k, v in zip(keys, values)})
                        dict_1["id"] = src
                        dict_1["location"] = "pod::id::contains::bae2df8c-52b8-11ea-9b46-6ed72e870cd8;<pod>"
                        dict_1["location_type"] = "pod"
                        dict_1["location_id"] = "id_bae2df8c-52b8-11ea-9b46-6ed72e870cd8;<pod>"
                        dict_1["event_type"] = "k8s_event__Pulling_Normal"
                        dict_1["event_name"] = "Pulling_Normal"
                        dict_1["event_source"] = "k8s_event"
                        dict_1["detail_info"] = "2020-02-19 10:15:01/1582078501 , pod ts-travel-plan-service-7f74dc8dd8-wfwtt  occurs pulling image \"libw521/ts-travel-plan-service\" , event level Normal"
                        dict_1["time"] = "2020-02-19 10:15:01"
                        dict_1["time_stamp"] = timestp
                        timestp += 1
                        dict_1["query"] = ""
                        dict_1["request_ip"] = ""
                        dict_1["loc_nickname"] = "train-ticket-istio_ts-travel-plan-service"
                        dict_2["id"] = dst
                        dict_2["location"] = "pod::id::contains::bae2df8c-52b8-11ea-9b46-6ed72e870cd8;<pod>"
                        dict_2["location_type"] = "pod"
                        dict_2["location_id"] = "id_bae2df8c-52b8-11ea-9b46-6ed72e870cd8;<pod>"
                        dict_2["event_type"] = "k8s_event__Pulling_Normal"
                        dict_2["event_name"] = "Pulling_Normal"
                        dict_2["event_source"] = "k8s_event"
                        dict_2["detail_info"] = "2020-02-19 10:15:01/1582078501 , pod ts-travel-plan-service-7f74dc8dd8-wfwtt  occurs pulling image \"libw521/ts-travel-plan-service\" , event level Normal"
                        dict_2["time"] = "2020-02-19 10:15:01"
                        dict_2["time_stamp"] = timestp
                        timestp += 1
                        dict_2["query"] = ""
                        dict_2["request_ip"] = ""
                        dict_2["loc_nickname"] = "train-ticket-istio_ts-travel-plan-service"
                        all_values.append(dict_1)
                        all_values.append(dict_2)
                        add_edge(src, dst, {"type": obj["type"]})
            else:
                add_edge(obj["src"], obj["dst"], {"type": obj["type"]})
        except KeyError as e:
            logger.error(f"{e!r} obj={pformat(obj)}")
    if output_dir is not None:
        dot_path = output_dir / f"{path.name}.graph"
        write_dot(g, dot_path)
        # noinspection SpellCheckingInspection
        os.system(f'dot -Tpdf -O \'{dot_path}\'')
    if not len(list(nx.weakly_connected_components(g))) <= 1:
        logger.warning(f"{path!s} is not a DAG: {list(nx.weakly_connected_components(g))=}")
    return g, all_values

path = "/workspace/data/D/graphs"
temp_str = "events_initial_"
dst_file = "/workspace/data_preprocess/events_initial"
for files in os.listdir(path):
    print(files)
    file_name = files.split('.')
    print(file_name[0])
    file_name1 = file_name[0].split('_')
    print(file_name1[1])
    print(int(file_name1[1]))
    end_stamp = int(file_name1[1]) + 300
    print(end_stamp)
    file_name_real = temp_str + file_name1[1] + '-' + str(end_stamp) + ".json"
    print(file_name_real)
    file_path_real_name = os.path.join(dst_file,file_name_real)
    print(file_path_real_name)
    g, all_values = parse_yaml_graph_config(os.path.join(path,files))
    all_values_dump = json.dumps(all_values)
    with open(file_path_real_name, 'w') as f:
        f.write(all_values_dump)
    f.close()

